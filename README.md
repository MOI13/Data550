# Git exercise

> Practice with commits, merges, and pushes

------------------------------------------------------------------------

## Initial code description

`code/01_make_output1.R`

-   generates random numbers
-   saves numbers as three different `.rds` objects in `output/` folder

`code/02_render_report.R`

-   renders `report.Rmd`

`report.Rmd`

-   reads random numbers generated by `code/01_make_output1.R`
-   makes three histograms

`Makefile`

-   contains rules for building the report
-   `make .random_numbers` will generate the three `.rds` files needed to compile the report
-   it will also create an empty file called `.random_numbers` in the project root directory, so that `make` properly knows when to update outputs

------------------------------------------------------------------------

## git exercise description

### Make a stable code base

1.  Confirm that you can build the report by executing `make`.
    -   If the report does not build, correct code until it builds correctly

### Initialize git repository

1.  Use `git init` to initialize a git repository in the `project4` folder
2.  Create a `.gitignore` file that ignores:
    -   all `.rds` files in the `output` directory
    -   all `.html` files in the project directory
    -   the empty `.random_numbers` file that is created by running `make .random_numbers`
3.  Appropriately use `git status`, `git add`, and `git commit` to create your first commit. The commit should include:
    -   all contents of the `code` directory
    -   `report.Rmd`
    -   `README.md`
    -   `Makefile`
    -   `.gitignore`
    -   the `output` directory but none of its contents (other than `.gitkeep` file)

At this point the `main` branch should have 1 commit.

### Create a new branch

Now, we want to add a fourth set of numbers to our report. However, because we have a stable code base already, we want to use branches to work on this code.

1.  In your local repo, create and checkout a new branch called `devel` by executing `git checkout -b devel`.
    -   confirm that you have switched to the new branch by executing `git branch`
    -   you should see a star next to the devel branch
2.  Add the following lines to `code/01_make_output.R` (ignore the lines with back ticks):

``` r
set.seed(4)
random_numbers4 <- rbinom(100, 1, 0.25)
```

3.  Add additional lines of code to save `random_numbers4` object into the `output` folder. Be sure to appropriately use `here` to do this!
4.  Confirm that `random_numbers4` gets created and saved properly (e.g., by running `make .random_numbers`).
5.  Confirm that you can rebuild the report entirely from scratch by executing `make clean` (to remove any existing output files) and then executing `make`.
6.  Once you have rebuilt the report from scratch, use `git add` and `git commit` to make a new commit along the `devel` branch.
    -   include a meaningful commit message
7.  Add a line to the `load-random-numbers` code chunk of `report.Rmd` that loads `random_numbers4.rds` from the output folder.
8.  Add a new section to `report.Rmd` called "Random numbers 4"
    -   the contents of the section should be exactly the same as the other sections
    -   e.g., you can copy/paste the "Random numbers 3" section and appropriately modify its contents
9.  Modify the title of `report.Rmd` to read "Four sets of random numbers"
10. Confirm that you can build the report from scratch by executing `make clean` and `make`.
11. Once you are confident that `report.html` is building properly, appropriately use `git add` and `git commit` to make a new commit along the `devel` branch.
    -   include a meaningful commit message

At this point:

-   the `main` branch should have 1 commit.
-   the `devel` branch should have 3 commits.

### Merge `devel` branch

1.  Once you have successfully made your commits to the `devel` branch, merge it into `main`.
    -   `git checkout main` (or replace `main` with `master` if needed)
    -   `git merge devel`
2.  Use `git log --oneline` to confirm that the merge executed correctly. You should see `HEAD`, `main`, and `devel` pointing to your most recent commit.
3.  Delete the `devel` branch by running `git branch -d devel`.

### Create a `big-data` branch

1.  Create and checkout a new branch called `big-data`.
2.  Modify `code/01_make_output.R` to sample `1000` observations from each distribution instead of `100`.
    -   I.e., replace `100` by `1000` anywhere you find `100` in the code.
3.  Modify the title of `report.Rmd` to read "Four large sets of random numbers"
4.  Confirm that your changes work as expected (e.g., by running `make clean` and `make`, and then examining contents of the report).
5.  `add` and `commit` your changes on the `big-data` branch
6.  `add` and `commit` your changes on the `big-data` branch

### Create conflicts on the `main` branch

We are now going to checkout the `main` branch, and make modifications that will result in conflicts when we try to merge in `big-data`.

1.  Checkout the `main` branch
2.  Modify `code/01_make_output.R` to sample `10` observations from each distribution instead of `100`.
    -   I.e., replace `100` by `10` everywhere `100` appears in the code.
3.  Modify the title of `report.Rmd` to read "Three small sets of random numbers"
4.  Confirm that your changes work (e.g., by running `make clean` and `make`, and then examining contents of the report).
5.  `add` and `commit` your changes on the `main` branch

### `merge` and resolve conflicts

1.  Attempt to merge the `big-data` branch into `main` by running `git merge big-data`. You should see an error about merge conflicts
2.  Resolve conflicts in `code/01_make_output.R` and `report.Rmd`.
    -   Open files and find where conflicts occurred (e.g., search for `<<<<` symbol)
    -   Delete the extra symbols and the code from the `main` branch (i.e., leave in the contents of the big-data branch)
    -   Save files after you have made changes
3.  Confirm that your conflict resolution results in a stable report build (e.g., by running `make clean` and `make`).
4.  Once you are satisfied that the report is correct, appropriately use `git status`, `git add`, and `git commit` to make a merge commit.
5.  Confirm the merge by running `git log --oneline` and examining the contents.
6.  Delete the `big-data` branch.
